<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <link rel="stylesheet" href="//cdn.rawgit.com/milligram/milligram/master/dist/milligram.min.css">
        <title>Connexion livre blanc</title>
    </head>
    <body>
        
        <h1>Remplissez le formulaire pour télécharger notre livre blanc</h1>

        <form action="">
            <input type="text" name="user_name" placeholder="Nom complet">
            <input type="email" name="user_email" placeholder="Email">
            <input type="number" name="userAge" placeholder="Age">
            <button type="submit">Valider</button>
        </form>

        <script
        src="https://code.jquery.com/jquery-2.2.4.min.js"
        integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
        crossorigin="anonymous"></script>

        <script>
        
            // Déclarer les variables
            var myForm = $('form');
            var userName = $('[name="user_name"]');
            var userEmail = $('[name="user_email"]');
            var userAge = $('[name="userAge"]');

            // Capter la soumission du formulaire
            myForm.submit( function(event) {
                // Bloquer le comportement du formulaire
                event.preventDefault();

                // Définir une variable pour les erreurs
                var formError = 3;
                
                // Vérifier le nom
                if( userName.val().length >= 2 ){
                    // Success
                    formError = formError - 1;

                } else { alert('Nom obligatoire') };

                // Vérifier l'email
                if( userEmail.val().length >= 5 ){
                    // Success
                    formError = formError - 1;

                } else { alert('Email obligatoire') };

                // Vérifier l'age
                if( userAge.val() > 0 ){
                    // Success
                    formError = formError - 1;

                } else { alert('Age obligatoire') };

                // Validation finale du formulaire
                if( formError === 0 ){
                    // Stocker en localStorage l'email de l'utilisateur
                    localStorage.setItem( 'userEmail', userEmail.val() );
                    
                    window.location.assign('protected.html');
                };

            });
        
        </script>

    </body>
</html>